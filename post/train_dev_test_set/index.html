<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.42.2" />
  <meta name="author" content="Jaehyuk Park">

  
  
  
  
    
      
    
  
  <meta name="description" content="1. Why Does It Matter? Or When Does It Matter? In one of my current projects, our team try to generate a machine learning model to predict whether some rare event would be happened or not. Since we don&rsquo;t want to use any information from our test set, even in overall descriptive statistics, how to divide our whole dataset into train/dev/test sets becomes one of our concern before further analyses.">

  
  <link rel="alternate" hreflang="en-us" href="https://jaehyukpark.github.io/post/train_dev_test_set/">

  


  

  
  
  <meta name="theme-color" content="hsl(339, 90%, 68%)">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source&#43;Sans:400,700%7cFira&#43;Sans:400,400italic,700%7cRoboto&#43;Slab">
  
  <link rel="stylesheet" href="/styles.css">
  

  
  
  

  
  <link rel="alternate" href="https://jaehyukpark.github.io/index.xml" type="application/rss+xml" title="JAEHYUK PARK">
  <link rel="feed" href="https://jaehyukpark.github.io/index.xml" type="application/rss+xml" title="JAEHYUK PARK">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jaehyukpark.github.io/post/train_dev_test_set/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@simply_jaehyuk">
  <meta property="twitter:creator" content="@simply_jaehyuk">
  
  <meta property="og:site_name" content="JAEHYUK PARK">
  <meta property="og:url" content="https://jaehyukpark.github.io/post/train_dev_test_set/">
  <meta property="og:title" content="Dividing train/dev/test sets in machine learning | JAEHYUK PARK">
  <meta property="og:description" content="1. Why Does It Matter? Or When Does It Matter? In one of my current projects, our team try to generate a machine learning model to predict whether some rare event would be happened or not. Since we don&rsquo;t want to use any information from our test set, even in overall descriptive statistics, how to divide our whole dataset into train/dev/test sets becomes one of our concern before further analyses.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-07-27T22:44:28-04:00">
  
  <meta property="article:modified_time" content="2018-07-27T22:44:28-04:00">
  

  

  

  <title>Dividing train/dev/test sets in machine learning | JAEHYUK PARK</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" class="dark">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">JAEHYUK PARK</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Dividing train/dev/test sets in machine learning</h1>

    

<div class="article-metadata">

  
  
  <div itemprop="author">
    Jaehyuk Park
    
  </div>
  

  <span class="article-date">
    
    <meta content="2018-07-27 22:44:28 -0400 -0400" itemprop="datePublished">
    <time datetime="2018-07-27 22:44:28 -0400 -0400" itemprop="dateModified">
      Jul 27, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jaehyuk Park">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 min read
  </span>
  

  
  

  
  
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Dividing%20train%2fdev%2ftest%20sets%20in%20machine%20learning&amp;url=https%3a%2f%2fjaehyukpark.github.io%2fpost%2ftrain_dev_test_set%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fjaehyukpark.github.io%2fpost%2ftrain_dev_test_set%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fjaehyukpark.github.io%2fpost%2ftrain_dev_test_set%2f&amp;title=Dividing%20train%2fdev%2ftest%20sets%20in%20machine%20learning"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fjaehyukpark.github.io%2fpost%2ftrain_dev_test_set%2f&amp;title=Dividing%20train%2fdev%2ftest%20sets%20in%20machine%20learning"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Dividing%20train%2fdev%2ftest%20sets%20in%20machine%20learning&amp;body=https%3a%2f%2fjaehyukpark.github.io%2fpost%2ftrain_dev_test_set%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      

<h1 id="1-why-does-it-matter-or-when-does-it-matter">1. Why Does It Matter? Or When Does It Matter?</h1>

<p>In one of my current projects, our team try to generate a machine learning model
to predict whether some rare event would be happened or not.
Since we don&rsquo;t want to use any information from our test set, even in overall
descriptive statistics, how to divide our whole dataset into train/dev/test
sets becomes one of our concern before further analyses.
Training set is the data to be used for training our model,
and dev set is the data to compare and select among multiple models
(having different hyperparameters, layers, evaluation functions, etc.),
while test set is to finally test the accuarcy of our selected model.</p>

<p>Hence, I decided to survey some tips and advices from existing works
such as machine learning blog articles and academic papers.
Although some of them are not related to our current concern, I
put it here if it seems useful in other future cases.</p>

<h1 id="2-advices-from-blogs-and-online-lectures">2. Advices from blogs and online lectures</h1>

<h2 id="1-sequential-splitting-vs-random-splitting">(1) Sequential splitting vs. Random splitting</h2>

<p><a href="https://docs.aws.amazon.com/machine-learning/latest/dg/splitting-types.html" target="_blank">Amazon Machine Learning Developer Guide</a>
seems supporting the sequential splitting in our case.
Similar to our prediction problem, it introduces prediction during certain
time range based on previous time range as a representative
example for sequential splitting.</p>

<h2 id="2-proportion-of-train-dev-test-sets">(2) Proportion of train/dev/test sets</h2>

<p>What proportions of dataset are generally assigned for dev and test sets?
According to the online lecture &ldquo;<a href="https://www.coursera.org/lecture/deep-neural-network/train-dev-test-sets-cxG1s" target="_blank">Train/Dev/ Test sets</a>&rdquo; by
Andrew Ng, it depends on the size of dataset.
For example, if the total number of data is about 100, 1000, or 10,000,
dividing train/dev/test into 60%/20%/20% is more general.
However, if your dataset including more than about a million records,
assigning 10,000 records for each of dev and test sets would be okay
to obtain a reliable accuracy test result.</p>

<p>Our dataset has far more than a million records so assigning 10,000 to
100,000 records during the last time period would be okay according to
the lecture. However, if I consider the number of events in the dataset,
because it&rsquo;s a rare event, 10,000 records would only
include 10 to 100 events which makes me not sure whether this is enough
size to measure the accuracy correctly.</p>

<h2 id="3-when-most-of-training-data-and-upcoming-target-data-have-different-distribution">(3) When most of training data and upcoming target data have different distribution</h2>

<p>The Medium article,
<a href="https://medium.com/@anilvedala/mismatched-training-and-dev-sets-in-deep-learning-5c84b2b6d207" target="_blank">Mismatched training and dev sets in Deep Learning</a>,
deal with the situation when the distribution of train set would be different
from that of test set or future target data. For instance, to develop a deep learning
algorithm that classifies cat pictures from non-cat pictures in mobile phone,
developer collected a large amount of high-quality of pictures and
comparatively small number of low-quality mobile pictures, which is closer
to the target data.</p>

<p>In that situation, the article recommends dividing the small mobile picture data
into the three sets of dataset &mdash; train, dev (using in validation process),
and test sets &mdash; with the ratio about 2:1:1. Then, by comparing the accuracies
on four sets of data &mdash; train, train+dev, dev, and test,
we can diagnose the model whether it&rsquo;s overfitted or underfitted.
Additionally, the lecture &ldquo;<a href="https://www.coursera.org/lecture/deep-neural-network/train-dev-test-sets-cxG1s" target="_blank">Train/Dev/Test sets</a>&rdquo; emphasizes to make sure
that dev set and test set are from a same distribution.</p>

<p>The dataset of our project doesn&rsquo;t have the different distribution issue,
so this section is more for the future.</p>

<h1 id="3-examples-from-previous-researches">3. Examples from previous researches</h1>

<h2 id="1-25-25-50">(1) 25% - 25% - 50%</h2>

<p>In a <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5176360/" target="_blank">recent research</a>
on the prediction of short-term mortality,
dataset is generated through random sampling of 20,000 patients for
each type of target diseases, from the national samples including 0.8 to
2.7 million people depending on disease. Then they split equally into
train and test sets, that is, 10,000 for each set. The train set is again
splited into train and dev sets for parameter optimization, that is,
5,000 samples for each.</p>

<p>Similar to our case, the target class of the prediction is a rare cases
(10% or under), they applied both oversampling - creating duplicates of
the minority class - and undersampling - random sampling of non-events
only for train set and validate it with original (non-event biased) dev set.</p>

    </div>

    


<div class="article-tags">
  
  <a class="label label-default" href="https://jaehyukpark.github.io/tags/machine-learning/">machine learning</a>
  
  <a class="label label-default" href="https://jaehyukpark.github.io/tags/training/">training</a>
  
  <a class="label label-default" href="https://jaehyukpark.github.io/tags/know-how/">know-how</a>
  
  <a class="label label-default" href="https://jaehyukpark.github.io/tags/deep-learning/">deep learning</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/publication/style_in_the_age_of_instagram_cscw_2016/">Style in the Age of Instagram</a></li>
        
      </ul>
    </div>
    

    

    


  </div>
</article>

<footer class="site-footer">
  <div class="container">

    

    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        CommonHTML: { linebreaks: { automatic: true } },
        tex2jax: { inlineMath: [ ['$', '$'], ['\\(','\\)'] ], displayMath: [ ['$$','$$'], ['\\[', '\\]'] ], processEscapes: false },
        TeX: { noUndefined: { attributes: { mathcolor: 'red', mathbackground: '#FFEEEE', mathsize: '90%' } } },
        messageStyle: 'none'
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous"></script>
    
    

  </body>
</html>

